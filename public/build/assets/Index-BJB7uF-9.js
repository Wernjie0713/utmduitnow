import{r as g,j as e,H as M,b as R}from"./app-qetWhnOG.js";import{A as V}from"./AuthenticatedLayout-YHDnYIvS.js";import{I,X as H}from"./popover-Bnp3oNpM.js";import{B as h}from"./button-Dq77yllh.js";import{S as E,a as W,b as B,c as F,d as c}from"./select-DkVS-V2O.js";import{D as K,b as L,c as z,e as X}from"./dropdown-menu-Zy0Muw2T.js";import{T as Y,a as q,b as f,c as G,d as J,e as O}from"./table-CputeLm7.js";import{P as Q,a as U,b as i,c as Z,d as x,e as b,f as $}from"./pagination-CiAMaxve.js";import{A as v,a as N,b as C}from"./alert-s7hvO5TJ.js";import{u as ee,f as w,g as se}from"./index-uT7o79MQ.js";import{columns as re}from"./columns-BP2Rzd9D.js";import{C as y}from"./circle-alert-C0rKU405.js";import{S as ae}from"./search-Ojkhz5k7.js";import{C as te}from"./use-controlled-state-AiZYFvZO.js";import"./ApplicationLogo-DZ3cp5zd.js";import"./transition-C7jrS6w9.js";import"./UserAvatar-Of6IaFkl.js";import"./utils-DxrgW60L.js";import"./proxy-DOP5oCNK.js";import"./index-VZjm6uBK.js";import"./createLucideIcon-DKCLQZta.js";import"./log-out-CC9EDxz3.js";import"./floating-ui.utils.dom-Ds-VJJzb.js";import"./check-BxVQqN8H.js";import"./index-DtzJ2kgm.js";import"./badge-BFq0aVqz.js";import"./clock-B32cdV3L.js";import"./circle-x-Cgi1WW2_.js";import"./circle-check-DZezBkjo.js";import"./formatDistanceToNow-Coef0oCf.js";import"./en-US-CKZa3QIe.js";function He({transactions:a,filters:n,isExtendedPeriod:S=!1,extendedSubmissionEnd:_}){const[k,D]=g.useState({}),[p,u]=g.useState(n?.search||""),d=ee({data:a.data,columns:re,getCoreRowModel:se(),manualPagination:!0,manualFiltering:!0,manualSorting:!0,pageCount:a.last_page,state:{columnVisibility:k,pagination:{pageIndex:a.current_page-1,pageSize:n?.per_page||10}},onColumnVisibilityChange:D}),m=s=>{R.get(route("transactions.my"),{...n,...s},{preserveState:!0,preserveScroll:!0})},j=()=>{m({search:p,page:1})},P=()=>{u(""),m({search:"",page:1})},T=s=>{s.key==="Enter"&&j()},o=s=>{m({page:s})};return e.jsxs(V,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"My Transactions"}),children:[e.jsx(M,{title:"My Transactions"}),e.jsx("div",{className:"pt-2 pb-8",children:e.jsx("div",{className:"mx-auto max-w-7xl",children:e.jsx("div",{className:"bg-white",children:e.jsxs("div",{className:"p-6",children:[S&&e.jsxs(v,{className:"mb-6 border-blue-200 bg-blue-50",children:[e.jsx(y,{className:"h-4 w-4 text-blue-600"}),e.jsx(N,{className:"text-blue-900",children:"Week 3 Extended Submission Period"}),e.jsxs(C,{className:"text-blue-800",children:["Due to server downtime earlier this week, Week 3 submissions have been extended until"," ",e.jsx("strong",{children:_}),". You can submit both Week 3 (Nov 17-23) and Week 4 (Nov 24-30) transactions during this period."]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full sm:max-w-md",children:[e.jsx(I,{placeholder:"Search by Reference ID or Amount...",value:p,onChange:s=>u(s.target.value),onKeyPress:T,className:"flex-1"}),e.jsxs(h,{onClick:j,className:"bg-black hover:bg-gray-800 text-white flex-shrink-0",children:[e.jsx(ae,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Search"})]}),n?.search&&e.jsxs(h,{onClick:P,variant:"outline",className:"border-gray-300 flex-shrink-0",children:[e.jsx(H,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Clear"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 justify-end sm:justify-start",children:[e.jsxs(E,{value:String(n?.per_page||10),onValueChange:s=>m({per_page:s,page:1}),children:[e.jsx(W,{className:"w-[120px]",children:e.jsx(B,{})}),e.jsxs(F,{children:[e.jsx(c,{value:"10",children:"10 rows"}),e.jsx(c,{value:"20",children:"20 rows"}),e.jsx(c,{value:"30",children:"30 rows"}),e.jsx(c,{value:"50",children:"50 rows"}),e.jsx(c,{value:"100",children:"100 rows"})]})]}),e.jsxs(K,{children:[e.jsx(L,{asChild:!0,children:e.jsxs(h,{variant:"outline",children:["Columns",e.jsx(te,{className:"ml-2 h-4 w-4"})]})}),e.jsx(z,{align:"end",children:d.getAllColumns().filter(s=>s.getCanHide()).map(s=>e.jsx(X,{checked:s.getIsVisible(),onCheckedChange:r=>s.toggleVisibility(!!r),children:s.columnDef.meta?.label||s.id},s.id))})]})]})]}),a.data.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:e.jsx("p",{children:"No transactions found."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(Y,{children:[e.jsx(q,{children:d.getHeaderGroups().map(s=>e.jsx(f,{children:s.headers.map(r=>e.jsx(G,{className:"border-r last:border-r-0",children:r.isPlaceholder?null:w(r.column.columnDef.header,r.getContext())},r.id))},s.id))}),e.jsx(J,{children:d.getRowModel().rows.map(s=>e.jsx(f,{children:s.getVisibleCells().map(r=>e.jsx(O,{className:"border-r last:border-r-0",children:w(r.column.columnDef.cell,r.getContext())},r.id))},s.id))})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-center justify-between gap-3 sm:gap-0 mt-4",children:[e.jsxs("div",{className:"text-sm text-gray-500 w-full sm:w-auto text-center sm:text-left",children:["Showing ",a.from||0," to ",a.to||0," of"," ",a.total," results"]}),e.jsx(Q,{className:"mx-0 w-full sm:w-auto justify-center sm:justify-end",children:e.jsxs(U,{children:[e.jsx(i,{children:e.jsx(Z,{href:"#",onClick:s=>{s.preventDefault(),a.prev_page_url&&o(a.current_page-1)},className:a.prev_page_url?"cursor-pointer":"pointer-events-none opacity-50"})}),(()=>{const s=[],r=a.current_page,l=a.last_page;l>0&&s.push(e.jsx(i,{children:e.jsx(x,{href:"#",onClick:t=>{t.preventDefault(),o(1)},isActive:r===1,className:"cursor-pointer",children:"1"})},1)),r>3&&s.push(e.jsx(i,{children:e.jsx(b,{})},"ellipsis-1"));for(let t=Math.max(2,r-1);t<=Math.min(l-1,r+1);t++)s.push(e.jsx(i,{children:e.jsx(x,{href:"#",onClick:A=>{A.preventDefault(),o(t)},isActive:r===t,className:"cursor-pointer",children:t})},t));return r<l-2&&s.push(e.jsx(i,{children:e.jsx(b,{})},"ellipsis-2")),l>1&&s.push(e.jsx(i,{children:e.jsx(x,{href:"#",onClick:t=>{t.preventDefault(),o(l)},isActive:r===l,className:"cursor-pointer",children:l})},l)),s})(),e.jsx(i,{children:e.jsx($,{href:"#",onClick:s=>{s.preventDefault(),a.next_page_url&&o(a.current_page+1)},className:a.next_page_url?"cursor-pointer":"pointer-events-none opacity-50"})})]})})]})]}),a.data.some(s=>s.status==="rejected"&&s.rejection_reason)&&e.jsxs("div",{className:"mt-6 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Recent Rejections:"}),a.data.filter(s=>s.status==="rejected"&&s.rejection_reason).slice(0,3).map(s=>e.jsxs(v,{variant:"destructive",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsxs(N,{children:["Transaction ",s.reference_id]}),e.jsx(C,{children:s.rejection_reason})]},s.id))]})]})})})})]})}export{He as default};
