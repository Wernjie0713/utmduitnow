import{r as j,j as e,H as M,L as R,b as V}from"./app-B9lfnha4.js";import{A as I}from"./AuthenticatedLayout-UtQUiQ-w.js";import{I as H,X as E}from"./popover-BTgurNBe.js";import{B as h}from"./button-DBKSr4MI.js";import{S as L,e as W,f as B,g as F,h as c,D as K,b as z,c as X,i as Y}from"./select-ySBbetOo.js";import{T as q,a as G,b as f,c as J,d as O,e as Q}from"./table-n4pZIN_y.js";import{P as U,a as Z,b as l,c as $,d as x,e as b,f as ee}from"./pagination-ClswqU7-.js";import{A as v,a as N,b as C}from"./alert-D0tD5Wb9.js";import{u as se,f as w,g as ae}from"./index-LcOCT_RW.js";import{columns as re}from"./columns-BRcJdYwg.js";import{C as y}from"./circle-alert-C1UQ20LB.js";import{S as te}from"./search-DQfGnZRH.js";import{C as ie}from"./use-controlled-state-DT5lt6wS.js";import"./ApplicationLogo-zd4BETSS.js";import"./transition-B80scv3U.js";import"./UserAvatar-COCHZlMW.js";import"./utils-DxrgW60L.js";import"./proxy-CT6J4zB_.js";import"./index-G18pQgYs.js";import"./createLucideIcon-Ddh1YYn5.js";import"./log-out-CrQfjdpH.js";import"./floating-ui.utils.dom-Ds-VJJzb.js";import"./index-BztIbe42.js";import"./check-CVm0OMmE.js";import"./badge-B1AQ0ii8.js";import"./clock-ijXwse84.js";import"./circle-x-BYzgDugE.js";import"./circle-check-BA0GhR6O.js";import"./formatDistanceToNow-Coef0oCf.js";import"./en-US-CKZa3QIe.js";function He({transactions:r,filters:n,isExtendedPeriod:S=!1,extendedSubmissionEnd:_}){const[k,D]=j.useState({}),[u,p]=j.useState(n?.search||""),d=se({data:r.data,columns:re,getCoreRowModel:ae(),manualPagination:!0,manualFiltering:!0,manualSorting:!0,pageCount:r.last_page,state:{columnVisibility:k,pagination:{pageIndex:r.current_page-1,pageSize:n?.per_page||10}},onColumnVisibilityChange:D}),m=s=>{V.get(route("transactions.my"),{...n,...s},{preserveState:!0,preserveScroll:!0})},g=()=>{m({search:u,page:1})},P=()=>{p(""),m({search:"",page:1})},T=s=>{s.key==="Enter"&&g()},o=s=>{m({page:s})};return e.jsxs(I,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"My Transactions"}),children:[e.jsx(M,{title:"My Transactions"}),e.jsx("div",{className:"pt-2 pb-8",children:e.jsx("div",{className:"mx-auto max-w-7xl",children:e.jsx("div",{className:"bg-white",children:e.jsxs("div",{className:"p-6",children:[S&&e.jsxs(v,{className:"mb-6 border-blue-200 bg-blue-50",children:[e.jsx(y,{className:"h-4 w-4 text-blue-600"}),e.jsx(N,{className:"text-blue-900",children:"Week 3 Extended Submission Period"}),e.jsxs(C,{className:"text-blue-800",children:["Due to server downtime earlier this week, Week 3 submissions have been extended until"," ",e.jsx("strong",{children:_}),". You can submit both Week 3 (Nov 17-23) and Week 4 (Nov 24-30) transactions during this period."]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full sm:max-w-md",children:[e.jsx(H,{placeholder:"Search by Reference ID or Amount...",value:u,onChange:s=>p(s.target.value),onKeyPress:T,className:"flex-1"}),e.jsxs(h,{onClick:g,className:"bg-black hover:bg-gray-800 text-white flex-shrink-0",children:[e.jsx(te,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Search"})]}),n?.search&&e.jsxs(h,{onClick:P,variant:"outline",className:"border-gray-300 flex-shrink-0",children:[e.jsx(E,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Clear"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 justify-end sm:justify-start",children:[e.jsxs(L,{value:String(n?.per_page||10),onValueChange:s=>m({per_page:s,page:1}),children:[e.jsx(W,{className:"w-[120px]",children:e.jsx(B,{})}),e.jsxs(F,{children:[e.jsx(c,{value:"10",children:"10 rows"}),e.jsx(c,{value:"20",children:"20 rows"}),e.jsx(c,{value:"30",children:"30 rows"}),e.jsx(c,{value:"50",children:"50 rows"}),e.jsx(c,{value:"100",children:"100 rows"})]})]}),e.jsxs(K,{children:[e.jsx(z,{asChild:!0,children:e.jsxs(h,{variant:"outline",children:["Columns",e.jsx(ie,{className:"ml-2 h-4 w-4"})]})}),e.jsx(X,{align:"end",children:d.getAllColumns().filter(s=>s.getCanHide()).map(s=>e.jsx(Y,{checked:s.getIsVisible(),onCheckedChange:a=>s.toggleVisibility(!!a),children:s.columnDef.meta?.label||s.id},s.id))})]})]})]}),r.data.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("p",{children:"No transactions found."}),e.jsx(R,{href:route("transactions.submit"),className:"mt-4 inline-block text-gray-900 hover:text-gray-700 font-medium",children:"Submit your first transaction"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(q,{children:[e.jsx(G,{children:d.getHeaderGroups().map(s=>e.jsx(f,{children:s.headers.map(a=>e.jsx(J,{className:"border-r last:border-r-0",children:a.isPlaceholder?null:w(a.column.columnDef.header,a.getContext())},a.id))},s.id))}),e.jsx(O,{children:d.getRowModel().rows.map(s=>e.jsx(f,{children:s.getVisibleCells().map(a=>e.jsx(Q,{className:"border-r last:border-r-0",children:w(a.column.columnDef.cell,a.getContext())},a.id))},s.id))})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-center justify-between gap-3 sm:gap-0 mt-4",children:[e.jsxs("div",{className:"text-sm text-gray-500 w-full sm:w-auto text-center sm:text-left",children:["Showing ",r.from||0," to ",r.to||0," of"," ",r.total," results"]}),e.jsx(U,{className:"mx-0 w-full sm:w-auto justify-center sm:justify-end",children:e.jsxs(Z,{children:[e.jsx(l,{children:e.jsx($,{href:"#",onClick:s=>{s.preventDefault(),r.prev_page_url&&o(r.current_page-1)},className:r.prev_page_url?"cursor-pointer":"pointer-events-none opacity-50"})}),(()=>{const s=[],a=r.current_page,i=r.last_page;i>0&&s.push(e.jsx(l,{children:e.jsx(x,{href:"#",onClick:t=>{t.preventDefault(),o(1)},isActive:a===1,className:"cursor-pointer",children:"1"})},1)),a>3&&s.push(e.jsx(l,{children:e.jsx(b,{})},"ellipsis-1"));for(let t=Math.max(2,a-1);t<=Math.min(i-1,a+1);t++)s.push(e.jsx(l,{children:e.jsx(x,{href:"#",onClick:A=>{A.preventDefault(),o(t)},isActive:a===t,className:"cursor-pointer",children:t})},t));return a<i-2&&s.push(e.jsx(l,{children:e.jsx(b,{})},"ellipsis-2")),i>1&&s.push(e.jsx(l,{children:e.jsx(x,{href:"#",onClick:t=>{t.preventDefault(),o(i)},isActive:a===i,className:"cursor-pointer",children:i})},i)),s})(),e.jsx(l,{children:e.jsx(ee,{href:"#",onClick:s=>{s.preventDefault(),r.next_page_url&&o(r.current_page+1)},className:r.next_page_url?"cursor-pointer":"pointer-events-none opacity-50"})})]})})]})]}),r.data.some(s=>s.status==="rejected"&&s.rejection_reason)&&e.jsxs("div",{className:"mt-6 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Recent Rejections:"}),r.data.filter(s=>s.status==="rejected"&&s.rejection_reason).slice(0,3).map(s=>e.jsxs(v,{variant:"destructive",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsxs(N,{children:["Transaction ",s.reference_id]}),e.jsx(C,{children:s.rejection_reason})]},s.id))]})]})})})})]})}export{He as default};
