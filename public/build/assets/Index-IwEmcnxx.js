import{r as g,j as e,H as M,b as R}from"./app-BJdaTNqI.js";import{A as V}from"./AuthenticatedLayout-B1UKtRnA.js";import{I,X as H}from"./popover-BWURJgjT.js";import{B as h}from"./button-DF_YCOm-.js";import{S as E,a as W,b as B,c as F,d as c}from"./select-DgENZMGv.js";import{D as K,a as L,b as z,d as X}from"./dropdown-menu-BjAiq1Pt.js";import{T as Y,a as q,b as f,c as G,d as J,e as O}from"./table-B8dgzD2h.js";import{P as Q,a as U,b as i,c as Z,d as x,e as b,f as $}from"./pagination-Ds5_Mi1g.js";import{A as v,a as N,b as C}from"./alert-yg9Wn2fS.js";import{u as ee,f as w,g as se}from"./index-BZcmTJqe.js";import{columns as ae}from"./columns-BboG77pK.js";import{C as y}from"./circle-alert-CUCqq0y1.js";import{S as re}from"./search-Ck0kxmk7.js";import{C as te}from"./use-controlled-state-DkZSzQIY.js";import"./ApplicationLogo-DgQIk4Ie.js";import"./transition-CDRgjYIX.js";import"./UserAvatar-7oWcXKi_.js";import"./utils-DxrgW60L.js";import"./proxy-CRcFvVbD.js";import"./index-DUWZ4qQK.js";import"./createLucideIcon-B79Mf7u7.js";import"./log-out-CTNyGy52.js";import"./floating-ui.utils.dom-Ds-VJJzb.js";import"./check-D1la7OOH.js";import"./index-BvgExRt0.js";import"./badge-YN655oJx.js";import"./clock-B6qnXkJU.js";import"./circle-x-WTbWCBso.js";import"./circle-check-DFmS3aEP.js";import"./formatDistanceToNow-Coef0oCf.js";import"./en-US-CKZa3QIe.js";function He({transactions:r,filters:n,isExtendedPeriod:S=!1,extendedSubmissionEnd:_}){const[k,D]=g.useState({}),[p,u]=g.useState(n?.search||""),d=ee({data:r.data,columns:ae,getCoreRowModel:se(),manualPagination:!0,manualFiltering:!0,manualSorting:!0,pageCount:r.last_page,state:{columnVisibility:k,pagination:{pageIndex:r.current_page-1,pageSize:n?.per_page||10}},onColumnVisibilityChange:D}),m=s=>{R.get(route("transactions.my"),{...n,...s},{preserveState:!0,preserveScroll:!0})},j=()=>{m({search:p,page:1})},P=()=>{u(""),m({search:"",page:1})},T=s=>{s.key==="Enter"&&j()},o=s=>{m({page:s})};return e.jsxs(V,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"My Transactions"}),children:[e.jsx(M,{title:"My Transactions"}),e.jsx("div",{className:"pt-2 pb-8",children:e.jsx("div",{className:"mx-auto max-w-7xl",children:e.jsx("div",{className:"bg-white",children:e.jsxs("div",{className:"p-6",children:[S&&e.jsxs(v,{className:"mb-6 border-blue-200 bg-blue-50",children:[e.jsx(y,{className:"h-4 w-4 text-blue-600"}),e.jsx(N,{className:"text-blue-900",children:"Week 3 Extended Submission Period"}),e.jsxs(C,{className:"text-blue-800",children:["Due to server downtime earlier this week, Week 3 submissions have been extended until"," ",e.jsx("strong",{children:_}),". You can submit both Week 3 (Nov 17-23) and Week 4 (Nov 24-30) transactions during this period."]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full sm:max-w-md",children:[e.jsx(I,{placeholder:"Search by Reference ID or Amount...",value:p,onChange:s=>u(s.target.value),onKeyPress:T,className:"flex-1"}),e.jsxs(h,{onClick:j,className:"bg-black hover:bg-gray-800 text-white flex-shrink-0",children:[e.jsx(re,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Search"})]}),n?.search&&e.jsxs(h,{onClick:P,variant:"outline",className:"border-gray-300 flex-shrink-0",children:[e.jsx(H,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Clear"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 justify-end sm:justify-start",children:[e.jsxs(E,{value:String(n?.per_page||10),onValueChange:s=>m({per_page:s,page:1}),children:[e.jsx(W,{className:"w-[120px]",children:e.jsx(B,{})}),e.jsxs(F,{children:[e.jsx(c,{value:"10",children:"10 rows"}),e.jsx(c,{value:"20",children:"20 rows"}),e.jsx(c,{value:"30",children:"30 rows"}),e.jsx(c,{value:"50",children:"50 rows"}),e.jsx(c,{value:"100",children:"100 rows"})]})]}),e.jsxs(K,{children:[e.jsx(L,{asChild:!0,children:e.jsxs(h,{variant:"outline",children:["Columns",e.jsx(te,{className:"ml-2 h-4 w-4"})]})}),e.jsx(z,{align:"end",children:d.getAllColumns().filter(s=>s.getCanHide()).map(s=>e.jsx(X,{checked:s.getIsVisible(),onCheckedChange:a=>s.toggleVisibility(!!a),children:s.columnDef.meta?.label||s.id},s.id))})]})]})]}),r.data.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:e.jsx("p",{children:"No transactions found."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(Y,{children:[e.jsx(q,{children:d.getHeaderGroups().map(s=>e.jsx(f,{children:s.headers.map(a=>e.jsx(G,{className:"border-r last:border-r-0",children:a.isPlaceholder?null:w(a.column.columnDef.header,a.getContext())},a.id))},s.id))}),e.jsx(J,{children:d.getRowModel().rows.map(s=>e.jsx(f,{children:s.getVisibleCells().map(a=>e.jsx(O,{className:"border-r last:border-r-0",children:w(a.column.columnDef.cell,a.getContext())},a.id))},s.id))})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-center justify-between gap-3 sm:gap-0 mt-4",children:[e.jsxs("div",{className:"text-sm text-gray-500 w-full sm:w-auto text-center sm:text-left",children:["Showing ",r.from||0," to ",r.to||0," of"," ",r.total," results"]}),e.jsx(Q,{className:"mx-0 w-full sm:w-auto justify-center sm:justify-end",children:e.jsxs(U,{children:[e.jsx(i,{children:e.jsx(Z,{href:"#",onClick:s=>{s.preventDefault(),r.prev_page_url&&o(r.current_page-1)},className:r.prev_page_url?"cursor-pointer":"pointer-events-none opacity-50"})}),(()=>{const s=[],a=r.current_page,l=r.last_page;l>0&&s.push(e.jsx(i,{children:e.jsx(x,{href:"#",onClick:t=>{t.preventDefault(),o(1)},isActive:a===1,className:"cursor-pointer",children:"1"})},1)),a>3&&s.push(e.jsx(i,{children:e.jsx(b,{})},"ellipsis-1"));for(let t=Math.max(2,a-1);t<=Math.min(l-1,a+1);t++)s.push(e.jsx(i,{children:e.jsx(x,{href:"#",onClick:A=>{A.preventDefault(),o(t)},isActive:a===t,className:"cursor-pointer",children:t})},t));return a<l-2&&s.push(e.jsx(i,{children:e.jsx(b,{})},"ellipsis-2")),l>1&&s.push(e.jsx(i,{children:e.jsx(x,{href:"#",onClick:t=>{t.preventDefault(),o(l)},isActive:a===l,className:"cursor-pointer",children:l})},l)),s})(),e.jsx(i,{children:e.jsx($,{href:"#",onClick:s=>{s.preventDefault(),r.next_page_url&&o(r.current_page+1)},className:r.next_page_url?"cursor-pointer":"pointer-events-none opacity-50"})})]})})]})]}),r.data.some(s=>s.status==="rejected"&&s.rejection_reason)&&e.jsxs("div",{className:"mt-6 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Recent Rejections:"}),r.data.filter(s=>s.status==="rejected"&&s.rejection_reason).slice(0,3).map(s=>e.jsxs(v,{variant:"destructive",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsxs(N,{children:["Transaction ",s.reference_id]}),e.jsx(C,{children:s.rejection_reason})]},s.id))]})]})})})})]})}export{He as default};
